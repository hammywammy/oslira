<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="../assets/images/oslira-logo.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self'; 
                   script-src 'self' https://cdn.jsdelivr.net https://unpkg.com 'unsafe-inline';
                   style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
                   font-src 'self' https://fonts.gstatic.com; 
                   connect-src 'self' https://*.supabase.co https://*.workers.dev; 
                   img-src 'self' data: https: https://*.weserv.nl;
                   frame-src https://js.stripe.com;">
    <title>Analytics - Oslira</title>
    <script src="/env-config.js"></script>
    <link rel="stylesheet" href="/css/analytics.css">
</head>
<body>
    
    //for the created functions and stuff(this is how to implement)
    <div id="heatmap-container"></div>
    <div id="cta-effectiveness-container"></div>
    <div id="feedback-signal-container"></div>
    <div id="message-style-matrix-container"></div>
    <div id="crm-performance-container"></div>
    <div id="outreach-timeline-container"></div>
    <div id="roi-tracker-container"></div>
    <div id="team-impact-dashboard"></div>
    <div id="claude-guidance-history" class="analytics-module"></div>

    




    
    <!-- ACCESSIBILITY -->
    <a href="#main-content" class="skip-nav">Skip to main content</a>
    
    <!-- MAIN LAYOUT CONTAINER -->
    <div class="analytics-dashboard">
        
        <!-- SIDEBAR NAVIGATION (Inherited from Dashboard) -->
        <aside class="sidebar" role="navigation" aria-label="Main navigation">
            <div class="logo">
                <img src="./assets/oslira-logo.png" alt="Oslira Logo" class="logo-image">
                Oslira
            </div>
            
            <!-- Business Context Selector -->
            <div class="business-selector">
                <h4>Active Business</h4>
                <select id="business-select" aria-label="Select active business">
                    <option value="">Select Business...</option>
                </select>
            </div>
            
            <!-- Navigation Menu -->
            <nav class="menu">
                <div class="menu-section">
                    <h4>Main</h4>
                    <a href="dashboard.html">
                        <span class="icon">üìä</span>
                        Dashboard
                    </a>
                    <a href="leads.html">
                        <span class="icon">üîç</span>
                        Lead Research
                    </a>
                    <a href="analytics.html" class="active">
                        <span class="icon">üìà</span>
                        Analytics
                    </a>
                </div>
                
                <div class="menu-section">
                    <h4>Tools</h4>
                    <a href="campaigns.html">
                        <span class="icon">üöÄ</span>
                        Campaigns
                    </a>
                    <a href="messages.html">
                        <span class="icon">üí¨</span>
                        Messages
                    </a>
                    <a href="integrations.html">
                        <span class="icon">üîó</span>
                        Integrations
                    </a>
                </div>
                
                <div class="menu-section">
                    <h4>Account</h4>
                    <a href="subscription.html">
                        <span class="icon">üí≥</span>
                        Subscription
                    </a>
                    <a href="settings.html">
                        <span class="icon">‚öôÔ∏è</span>
                        Settings
                    </a>
                </div>
            </nav>
            
            <!-- Subscription Status -->
            <div class="subscription-status">
                <h4>Current Plan</h4>
                <p class="plan-name" id="sidebar-plan">Loading...</p>
                <div class="credits-display" id="sidebar-billing">Loading...</div>
                <a href="subscription.html">Manage Subscription</a>
            </div>
            
            <!-- User Information -->
            <div class="user-info">
                <p id="user-email">Loading...</p>
                <a href="#" id="logout-link" data-action="logout">Sign Out</a>
            </div>
        </aside>
        
        <!-- MAIN CONTENT AREA -->
        <main role="main" id="main-content" class="main-content">
            
            <!-- PAGE HEADER WITH CONTROLS -->
            <header class="analytics-header">
                <div class="header-content">
                    <h1>üìà Analytics Intelligence</h1>
                    <p class="header-subtitle">Strategic performance insights and outreach optimization</p>
                </div>
                
                <!-- Global Controls Bar -->
                <div class="analytics-controls">
                    <!-- Time Range Selector -->
                    <div class="control-group">
                        <label for="time-range">Time Range</label>
                        <select id="time-range" class="control-select">
                            <option value="7d">Last 7 Days</option>
                            <option value="30d" selected>Last 30 Days</option>
                            <option value="90d">Last 90 Days</option>
                            <option value="1y">Last Year</option>
                            <option value="all">All Time</option>
                        </select>
                    </div>
                    
                    <!-- CRM Filter -->
                    <div class="control-group">
                        <label for="crm-filter">CRM Source</label>
                        <select id="crm-filter" class="control-select">
                            <option value="all">All CRMs</option>
                            <!-- Populated dynamically -->
                        </select>
                    </div>
                    
                    <!-- Lead Type Filter -->
                    <div class="control-group">
                        <label for="lead-type-filter">Lead Type</label>
                        <select id="lead-type-filter" class="control-select">
                            <option value="all">All Types</option>
                            <option value="personal_brand">Personal Brand</option>
                            <option value="business_page">Business Page</option>
                            <option value="creator">Creator</option>
                            <option value="meme_page">Meme Page</option>
                        </select>
                    </div>
                    
                    <!-- Data Refresh Controls -->
                    <div class="control-group">
                        <button id="refresh-data" class="control-btn primary">
                            üîÑ Refresh Data
                        </button>
                        <button id="export-analytics" class="control-btn secondary">
                            üì• Export Report
                        </button>
                    </div>
                </div>
            </header>
            
            <!-- ANALYTICS MODULES GRID -->
            <div class="analytics-grid">
                
                <!-- MODULE 1: Message Style Performance Matrix -->
                <section class="analytics-module matrix-module" id="message-style-matrix">
                    <div class="module-header">
                        <h2>üéØ Message Style Performance Matrix</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="matrix">‚õ∂</button>
                            <button class="module-settings" data-module="matrix">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <!-- 3D Matrix: Tone √ó Structure √ó Engagement -->
                        <div class="matrix-container">
                            <div class="matrix-axes">
                                <div class="axis-selector tone-axis">
                                    <label>Tone Axis</label>
                                    <select id="tone-axis-select">
                                        <option value="formal">Formal</option>
                                        <option value="casual">Casual</option>
                                        <option value="friendly">Friendly</option>
                                        <option value="professional">Professional</option>
                                    </select>
                                </div>
                                <div class="axis-selector structure-axis">
                                    <label>Structure Axis</label>
                                    <select id="structure-axis-select">
                                        <option value="short">Short Form</option>
                                        <option value="medium">Medium Form</option>
                                        <option value="long">Long Form</option>
                                        <option value="bullet">Bullet Points</option>
                                    </select>
                                </div>
                            </div>
                            <div class="matrix-visualization" id="style-matrix-chart"></div>
                            <div class="matrix-insights" id="style-matrix-insights">
                                <!-- AI-generated insights populate here -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 2: Lead Type Conversion Heatmap -->
                <section class="analytics-module heatmap-module" id="lead-conversion-heatmap">
                    <div class="module-header">
                        <h2>üî• Lead Type Conversion Heatmap</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="heatmap">‚õ∂</button>
                            <button class="module-settings" data-module="heatmap">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="heatmap-container">
                            <div class="heatmap-legend">
                                <div class="legend-item">
                                    <span class="legend-color high"></span>
                                    <span>High Performance</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color medium"></span>
                                    <span>Medium Performance</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-color low"></span>
                                    <span>Low Performance</span>
                                </div>
                            </div>
                            <div class="heatmap-visualization" id="conversion-heatmap-chart"></div>
                            <div class="heatmap-metrics" id="conversion-metrics">
                                <!-- Metrics populate here -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 3: CTA Effectiveness Tracker -->
                <section class="analytics-module cta-module" id="cta-effectiveness">
                    <div class="module-header">
                        <h2>üé™ CTA Effectiveness Tracker</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="cta">‚õ∂</button>
                            <button class="module-settings" data-module="cta">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="cta-tracker-container">
                            <div class="cta-filters">
                                <select id="cta-sort-by">
                                    <option value="engagement">By Engagement</option>
                                    <option value="conversion">By Conversion</option>
                                    <option value="reuse">By Reuse Rate</option>
                                    <option value="feedback">By Feedback Score</option>
                                </select>
                            </div>
                            <div class="cta-list" id="cta-effectiveness-list">
                                <!-- CTA performance items populate here -->
                            </div>
                            <div class="cta-recommendations" id="cta-recommendations">
                                <!-- AI recommendations populate here -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 4: Feedback Signal Explorer -->
                <section class="analytics-module feedback-module" id="feedback-explorer">
                    <div class="module-header">
                        <h2>üîç Feedback Signal Explorer</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="feedback">‚õ∂</button>
                            <button class="module-settings" data-module="feedback">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="feedback-explorer-container">
                            <div class="feedback-clusters" id="feedback-clusters">
                                <!-- Theme clusters populate here -->
                            </div>
                            <div class="feedback-trends" id="feedback-trends-chart">
                                <!-- Trend visualization -->
                            </div>
                            <div class="feedback-insights" id="feedback-ai-insights">
                                <!-- AI summarized insights -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 5: CRM Performance Comparator -->
                <section class="analytics-module crm-module" id="crm-performance">
                    <div class="module-header">
                        <h2>üèÜ CRM Performance Comparator</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="crm">‚õ∂</button>
                            <button class="module-settings" data-module="crm">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="crm-comparator-container">
                            <div class="crm-ranking" id="crm-ranking-table">
                                <!-- CRM performance table -->
                            </div>
                            <div class="crm-insights" id="crm-ai-insights">
                                <!-- Claude-generated insights -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 6: Outreach Timeline Overlay -->
                <section class="analytics-module timeline-module" id="outreach-timeline">
                    <div class="module-header">
                        <h2>üìÖ Outreach Timeline Overlay</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="timeline">‚õ∂</button>
                            <button class="module-settings" data-module="timeline">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="timeline-container">
                            <div class="timeline-visualization" id="timeline-chart">
                                <!-- Timeline with campaign overlays -->
                            </div>
                            <div class="timeline-events" id="timeline-events">
                                <!-- Event markers and correlations -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 7: Message Iteration ROI Tracker -->
                <section class="analytics-module iteration-module" id="iteration-tracker">
                    <div class="module-header">
                        <h2>üîÑ Message Iteration ROI Tracker</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="iteration">‚õ∂</button>
                            <button class="module-settings" data-module="iteration">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="iteration-tracker-container">
                            <div class="iteration-list" id="iteration-performance-list">
                                <!-- Before/after performance tracking -->
                            </div>
                            <div class="iteration-insights" id="iteration-roi-insights">
                                <!-- ROI analysis and recommendations -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 8: Team-Level Impact Dashboard -->
                <section class="analytics-module team-module" id="team-impact">
                    <div class="module-header">
                        <h2>üë• Team-Level Impact Dashboard</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="team">‚õ∂</button>
                            <button class="module-settings" data-module="team">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="team-dashboard-container">
                            <div class="team-performance" id="team-performance-breakdown">
                                <!-- Individual contributor analysis -->
                            </div>
                            <div class="team-coaching" id="team-coaching-insights">
                                <!-- Coaching recommendations -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 9: Claude Guidance History -->
                <section class="analytics-module claude-module" id="claude-guidance">
                    <div class="module-header">
                        <h2>ü§ñ Claude Guidance History</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="claude">‚õ∂</button>
                            <button class="module-settings" data-module="claude">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="claude-history-container">
                            <div class="guidance-timeline" id="claude-guidance-timeline">
                                <!-- Historical advice tracking -->
                            </div>
                            <div class="guidance-impact" id="guidance-impact-analysis">
                                <!-- Performance lift analysis -->
                            </div>
                            <div class="guidance-suggestions" id="new-experiment-suggestions">
                                <!-- New experimentation recommendations -->
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- MODULE 10: Message Risk Classifier -->
                <section class="analytics-module risk-module" id="risk-classifier">
                    <div class="module-header">
                        <h2>‚ö†Ô∏è Message Risk Classifier</h2>
                        <div class="module-controls">
                            <button class="module-expand" data-module="risk">‚õ∂</button>
                            <button class="module-settings" data-module="risk">‚öôÔ∏è</button>
                        </div>
                    </div>
                    <div class="module-content">
                        <div class="risk-classifier-container">
                            <div class="risk-dashboard" id="risk-overview-dashboard">
                                <!-- Risk score overview -->
                            </div>
                            <div class="risk-alerts" id="risk-alerts-panel">
                                <!-- Active risk alerts -->
                            </div>
                            <div class="risk-recommendations" id="risk-mitigation-recommendations">
                                <!-- Risk mitigation suggestions -->
                            </div>
                        </div>
                    </div>
                </section>
                
            </div>
            
        </main>
        
    </div>
    
    <!-- MODAL SYSTEMS -->
    
    <!-- Module Expansion Modal -->
    <div class="modal" id="module-expansion-modal">
        <div class="modal-content expanded-module-content">
            <button class="modal-close" id="module-modal-close">√ó</button>
            <div class="expanded-module-header">
                <h2 id="expanded-module-title">Module Title</h2>
                <div class="expanded-module-controls">
                    <!-- Module-specific controls -->
                </div>
            </div>
            <div class="expanded-module-body" id="expanded-module-content">
                <!-- Expanded module content -->
            </div>
        </div>
    </div>
    
    <!-- Settings Configuration Modal -->
    <div class="modal" id="module-settings-modal">
        <div class="modal-content">
            <button class="modal-close" id="settings-modal-close">√ó</button>
            <h3 id="settings-modal-title">Module Settings</h3>
            <div class="settings-form" id="module-settings-form">
                <!-- Dynamic settings form -->
            </div>
        </div>
    </div>
    
    <!-- Data Export Modal -->
    <div class="modal" id="export-modal">
        <div class="modal-content">
            <button class="modal-close" id="export-modal-close">√ó</button>
            <h3>üì• Export Analytics Report</h3>
            <div class="export-options">
                <div class="export-format">
                    <label>Export Format</label>
                    <select id="export-format-select">
                        <option value="pdf">PDF Report</option>
                        <option value="csv">CSV Data</option>
                        <option value="json">JSON Data</option>
                        <option value="xlsx">Excel Workbook</option>
                    </select>
                </div>
                <div class="export-modules">
                    <label>Include Modules</label>
                    <div class="module-checkboxes" id="export-module-selection">
                        <!-- Checkboxes for each module -->
                    </div>
                </div>
                <button class="primary-btn" id="generate-export">Generate Export</button>
            </div>
        </div>
    </div>
    
    <!-- LOADING OVERLAY -->
    <div class="loading-overlay" id="analytics-loading" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p id="loading-message">Loading analytics data...</p>
        </div>
    </div>
    
    <!-- SCRIPTS -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/recharts@2.8.0/lib/index.js"></script>
    <script src="/js/shared-code.js"></script>
    <script src="/js/analytics.js" defer></script>
    
</body>
</html>
