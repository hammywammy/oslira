<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="/assets/images/oslira-logo.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In - Oslira</title>
    <script src="/core/script-loader.js"></script>

    <script>
        // DEBUG: Trace form submission behavior
        console.log('üîç [DEBUG] Auth page loaded, setting up debugging...');
        
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('auth-form');
            const button = document.getElementById('signin-button');
            
            if (form) {
                console.log('üîç [DEBUG] Form found, adding listeners');
                
                // Track all submit events
                form.addEventListener('submit', (e) => {
                    console.log('üîç [DEBUG] Form submit event fired:', e);
                    console.log('üîç [DEBUG] preventDefault called?', e.defaultPrevented);
                    console.log('üîç [DEBUG] Event target:', e.target);
                });
                
                // Track form submission attempts
                form.addEventListener('submit', (e) => {
                    console.log('üîç [DEBUG] SECOND submit listener - this should not fire if first prevents default');
                }, true); // Use capture phase
            }
            
            if (button) {
                console.log('üîç [DEBUG] Button found, adding click listener');
                button.addEventListener('click', (e) => {
                    console.log('üîç [DEBUG] Button clicked:', e);
                    console.log('üîç [DEBUG] Button type:', button.type);
                    console.log('üîç [DEBUG] Form element:', button.form);
                });
            }
            
            // Check if app.js auth manager is available
            // Check if app.js auth manager is available
setTimeout(async () => {
    console.log('üîç [DEBUG] Checking auth manager availability...');
    console.log('üîç [DEBUG] window.OsliraApp:', !!window.OsliraApp);
    console.log('üîç [DEBUG] window.OsliraApp?.auth:', !!window.OsliraApp?.auth);
    console.log('üîç [DEBUG] window.OsliraAppInitializer:', !!window.OsliraAppInitializer);
    console.log('üîç [DEBUG] OsliraAppInitializer.getInstance():', window.OsliraAppInitializer?.getInstance?.());
    
    // Force initialization if not done
    if (window.OsliraAppInitializer && !window.OsliraAppInitializer.getInstance()) {
        console.log('üîç [DEBUG] Force initializing OsliraAppInitializer...');
        try {
            await window.OsliraAppInitializer.initialize();
            console.log('üîç [DEBUG] Force initialization complete');
            console.log('üîç [DEBUG] window.OsliraApp?.auth after init:', !!window.OsliraApp?.auth);
        } catch (error) {
            console.error('üîç [DEBUG] Force initialization failed:', error);
        }
    }
}, 3000);
        });
    </script>
    
    <link rel="stylesheet" href="/pages/auth/auth.css">
</head>
<body>
    <a href="#main-content" class="skip-nav">Skip to main content</a>
    
    <div class="auth-container" id="main-content">
        <!-- Main Sign In Card -->
        <div class="auth-card" id="main-card">
            <div class="auth-header">
                <div class="logo">
                    <img src="/assets/images/oslira-logo.png" alt="Oslira Logo" class="logo-image">
                    <h1>Oslira</h1>
                </div>
                <div class="auth-subtitle">Welcome back</div>
                <div class="auth-description">
                    Sign in to your account to continue analyzing leads and generating personalized outreach.
                </div>
            </div>

            <div class="error-message" id="error-display" role="alert" aria-live="polite">
                <!-- Error messages will appear here -->
            </div>

            <form id="auth-form" novalidate>
                <div class="form-group">
                    <label for="email" class="form-label">Email Address</label>
                    <input 
                        type="email" 
                        id="email" 
                        class="form-input"
                        placeholder="Enter your email address"
                        required
                        autocomplete="email"
                        aria-describedby="email-help"
                    >
                    <div id="email-help" class="form-help">
                        We'll send you a secure sign-in link
                    </div>
                </div>

               <button type="submit" class="auth-button" id="signin-button">
    <span class="button-text">Send Sign-In Link</span>
</button>
            </form>

            <div class="auth-footer">
                <p class="auth-note">
                    New to Oslira? The sign-in link will automatically create your account.
                </p>
                <p class="auth-links">
                    <a href="/">‚Üê Back to Home</a>
                    <span class="separator">‚Ä¢</span>
                    <a href="/privacy.html">Privacy Policy</a>
                    <span class="separator">‚Ä¢</span>
                    <a href="/terms.html">Terms</a>
                </p>
            </div>
        </div>

        <!-- Success State Card -->
        <div class="auth-card success-state" id="success-card" style="display: none;">
            <div class="success-icon">‚úì</div>
            <h2 class="success-title">Check Your Email</h2>
            <div class="success-description">
                We've sent a secure sign-in link to:
            </div>
            <div class="sent-email" id="sent-email">
                <!-- Email will be inserted here -->
            </div>
            <div class="success-description" style="margin-top: 16px;">
                Click the link in your email to sign in. The link will expire in 1 hour for security.
            </div>
            
            <div class="success-actions">
                <button type="button" class="auth-button secondary" onclick="window.location.reload()">
                    Try Different Email
                </button>
                <p class="success-note">
                    Didn't receive the email? Check your spam folder or try again in a few minutes.
                </p>
            </div>
        </div>
    </div>
</body>
</html>
