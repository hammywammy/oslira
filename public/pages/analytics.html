<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Intelligence - Oslira</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="./assets/oslira-logo.png"> 
    
    <!-- Environment Config -->
    <script src="/env-config.js"></script>
    
    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://js.sentry-cdn.com https://cdn.jsdelivr.net https://unpkg.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https: blob:; connect-src 'self' https: wss:; font-src 'self' data:; media-src 'self' blob: data:;">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/css/analytics.css">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="/js/shared-code.js" as="script">
    <link rel="preload" href="/js/analytics.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/chart.js" as="script">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Advanced analytics intelligence for AI-powered outreach campaigns and lead generation performance.">
    <meta name="keywords" content="analytics, AI outreach, lead generation, campaign performance, business intelligence">
    <meta name="author" content="Oslira">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Analytics Intelligence - Oslira">
    <meta property="og:description" content="Strategic command center for data-driven outreach optimization and performance insights">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://app.oslira.com/analytics">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Analytics Intelligence - Oslira">
    <meta name="twitter:description" content="Strategic command center for data-driven outreach optimization">
</head>
<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <aside class="sidebar" role="navigation" aria-label="Main navigation">
            <!-- Logo -->
            <div class="logo">
                <img src="./assets/oslira-logo.png" alt="Oslira" class="logo-image">
                <span>Oslira</span>
            </div>
            
            <!-- Navigation -->
            <nav class="nav">
                <div class="nav-section">
                    <h3>Tools</h3>
                    <a href="/dashboard" class="nav-link">
                        <span class="icon">🏠</span>
                        <span>Dashboard</span>
                    </a>
                    <a href="/message-studio" class="nav-link">
                        <span class="icon">✍️</span>
                        <span>Message Studio</span>
                    </a>
                    <a href="/campaigns" class="nav-link">
                        <span class="icon">🚀</span>
                        <span>Campaigns</span>
                    </a>
                    <a href="/analytics" class="nav-link active">
                        <span class="icon">📊</span>
                        <span>Analytics</span>
                    </a>
                    <a href="/integrations" class="nav-link">
                        <span class="icon">🔗</span>
                        <span>Integrations</span>
                    </a>
                </div>
                
                <!-- User Info -->
                <div class="user-info">
                    <p>Signed in as:</p>
                    <p><strong id="user-email">Loading...</strong></p>
                    <p>Plan: <span id="user-plan">Free</span></p>
                    <p>Credits: <span id="user-credits">0</span></p>
                    <a href="/account" class="nav-link">Account Settings</a>
                    <a href="#" class="nav-link" onclick="window.OsliraApp?.signOut()">Sign Out</a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content" role="main">
            <!-- Header -->
            <header class="analytics-header">
                <div class="header-content">
                    <div class="header-text">
                        <h1>Analytics Intelligence</h1>
                        <p>Strategic command center for data-driven outreach optimization and performance insights</p>
                        <div class="live-indicator">
                            <span class="live-dot"></span>
                            <span>Live Analytics</span>
                            <span class="last-updated">Last updated: <span id="last-update-time">--</span></span>
                        </div>
                    </div>
                    <div class="header-controls">
                        <div class="time-filter">
                            <button class="active" data-period="7d">7 Days</button>
                            <button data-period="30d">30 Days</button>
                            <button data-period="90d">90 Days</button>
                            <button data-period="1y">1 Year</button>
                        </div>
                        <button class="refresh-btn" id="refresh-analytics">
                            <span>🔄</span>
                            <span>Refresh</span>
                        </button>
                        <button class="export-btn" id="export-analytics">
                            <span>📊</span>
                            <span>Export</span>
                        </button>
                    </div>
                </div>
                
                <!-- View Navigation -->
                <div class="view-navigation" role="tablist" aria-label="Analytics views">
                    <button class="view-tab active" data-view="overview" role="tab" aria-selected="true" aria-controls="analytics-content">
                        <span class="icon">📊</span>
                        <span>Overview</span>
                    </button>
                    <button class="view-tab" data-view="message-performance" role="tab" aria-selected="false" aria-controls="analytics-content">
                        <span class="icon">💬</span>
                        <span>Message Performance</span>
                    </button>
                    <button class="view-tab" data-view="lead-conversion" role="tab" aria-selected="false" aria-controls="analytics-content">
                        <span class="icon">🎯</span>
                        <span>Lead Conversion</span>
                    </button>
                    <button class="view-tab" data-view="cta-analysis" role="tab" aria-selected="false" aria-controls="analytics-content">
                        <span class="icon">📣</span>
                        <span>CTA Analysis</span>
                    </button>
                    <button class="view-tab" data-view="feedback-explorer" role="tab" aria-selected="false" aria-controls="analytics-content">
                        <span class="icon">🧠</span>
                        <span>Feedback Explorer</span>
                    </button>
                    <button class="view-tab" data-view="claude-guidance" role="tab" aria-selected="false" aria-controls="analytics-content">
                        <span class="icon">🧭</span>
                        <span>Claude Guidance</span>
                    </button>
                    <button class="view-tab" data-view="risk-assessment" role="tab" aria-selected="false" aria-controls="analytics-content">
                        <span class="icon">🚦</span>
                        <span>Risk Assessment</span>
                    </button>
                </div>
            </header>
            
            <!-- Analytics Content -->
            <div class="analytics-content" id="analytics-content" role="tabpanel" aria-labelledby="current-view">
                <!-- Loading State -->
                <div class="analytics-loading" id="analytics-loading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>Loading analytics intelligence...</p>
                </div>
                
                <!-- Error State -->
                <div class="analytics-error" id="analytics-error" style="display: none;" role="alert">
                    <!-- Error content will be populated by JavaScript -->
                </div>
                
                <!-- Content will be dynamically populated by analytics.js -->
                <div class="analytics-placeholder">
                    <div class="placeholder-content">
                        <div class="placeholder-icon">🚀</div>
                        <h3>Initializing Analytics Intelligence</h3>
                        <p>Loading strategic insights and performance data...</p>
                        <div class="placeholder-animation">
                            <div class="dot"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Quick Insights Sidebar -->
    <aside class="insights-sidebar" id="insights-sidebar" role="complementary" aria-label="Quick insights">
        <div class="insights-header">
            <h3>🔥 Live Insights</h3>
            <button class="insights-toggle" id="insights-toggle" aria-label="Toggle insights panel">
                <span>→</span>
            </button>
        </div>
        
        <div class="insights-content" id="insights-content">
            <div class="insight-card trending">
                <div class="insight-icon">📈</div>
                <div class="insight-text">
                    <h4>Trending Up</h4>
                    <p>Response rates increased 23% this week</p>
                </div>
            </div>
            
            <div class="insight-card alert">
                <div class="insight-icon">⚠️</div>
                <div class="insight-text">
                    <h4>Attention Needed</h4>
                    <p>3 campaigns need optimization</p>
                </div>
            </div>
            
            <div class="insight-card success">
                <div class="insight-icon">✅</div>
                <div class="insight-text">
                    <h4>Top Performer</h4>
                    <p>"Professional Intro" variant at 45% response rate</p>
                </div>
            </div>
        </div>
    </aside>

    <!-- Modals -->
    <!-- Export Modal -->
    <div class="modal" id="export-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>📊 Export Analytics</h3>
                <button class="modal-close" onclick="analytics.closeModal('export-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-options">
                    <h4>Export Format</h4>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="export-format" value="pdf" checked>
                            <span class="radio-custom"></span>
                            <span>📄 PDF Report</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="export-format" value="csv">
                            <span class="radio-custom"></span>
                            <span>📊 CSV Data</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="export-format" value="excel">
                            <span class="radio-custom"></span>
                            <span>📈 Excel Workbook</span>
                        </label>
                    </div>
                    
                    <h4>Date Range</h4>
                    <div class="date-range">
                        <input type="date" id="export-start-date" class="form-input">
                        <span>to</span>
                        <input type="date" id="export-end-date" class="form-input">
                    </div>
                    
                    <h4>Include Sections</h4>
                    <div class="checkbox-group">
                        <label class="checkbox-option">
                            <input type="checkbox" checked>
                            <span class="checkbox-custom"></span>
                            <span>Performance Metrics</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" checked>
                            <span class="checkbox-custom"></span>
                            <span>Charts & Visualizations</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" checked>
                            <span class="checkbox-custom"></span>
                            <span>AI Insights</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox">
                            <span class="checkbox-custom"></span>
                            <span>Raw Data Tables</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="secondary-btn" onclick="analytics.closeModal('export-modal')">Cancel</button>
                <button class="primary-btn" onclick="analytics.exportAnalytics()">
                    <span>📊</span>
                    <span>Export Analytics</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Analysis Modal -->
    <div class="modal" id="analysis-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🔍 Deep Dive Analysis</h3>
                <button class="modal-close" onclick="analytics.closeModal('analysis-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="analysis-form">
                    <h4>What would you like to analyze?</h4>
                    <div class="form-group">
                        <label for="analysis-type">Analysis Type</label>
                        <select id="analysis-type" class="form-input">
                            <option value="performance">Message Performance Trends</option>
                            <option value="conversion">Conversion Optimization</option>
                            <option value="audience">Audience Segmentation</option>
                            <option value="timing">Timing Analysis</option>
                            <option value="content">Content Effectiveness</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="analysis-timeframe">Timeframe</label>
                        <select id="analysis-timeframe" class="form-input">
                            <option value="7d">Last 7 days</option>
                            <option value="30d">Last 30 days</option>
                            <option value="90d">Last 90 days</option>
                            <option value="1y">Last year</option>
                            <option value="custom">Custom range</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="analysis-filters">Additional Filters</label>
                        <div class="checkbox-group">
                            <label class="checkbox-option">
                                <input type="checkbox" value="high-performers">
                                <span class="checkbox-custom"></span>
                                <span>High-performing campaigns only</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" value="specific-industry">
                                <span class="checkbox-custom"></span>
                                <span>Specific industry focus</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" value="response-received">
                                <span class="checkbox-custom"></span>
                                <span>Messages with responses only</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="secondary-btn" onclick="analytics.closeModal('analysis-modal')">Cancel</button>
                <button class="primary-btn" onclick="analytics.runDeepAnalysis()">
                    <span>🔍</span>
                    <span>Run Analysis</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/js/shared-code.js"></script>
    <script src="/js/analytics.js" defer></script>
</body>
</html>
