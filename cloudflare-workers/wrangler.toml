name = "ai-outreach-api"
main = "src/index.ts"
compatibility_date = "2025-08-01"

routes = [
  { pattern = "api.oslira.com/*", zone_name = "oslira.com" }
]

[vars]
APP_ENV = "production"
FRONTEND_URL = "https://oslira.com"
USE_DIRECT_ANALYSIS = "false"
USE_SMART_BATCHING = "false"
ENABLE_PRE_SCREENING = "false"
USE_COMPRESSED_PROMPTS = "false"
ROLLOUT_PERCENTAGE = "0"

[env.staging]
name = "oslira-api-stg"
routes = [
  { pattern = "api-staging.oslira.com/*", zone_name = "oslira.com" }
]

[env.staging.vars]
APP_ENV = "staging" 
FRONTEND_URL = "https://osliratest.netlify.app"
USE_DIRECT_ANALYSIS = "true"
USE_SMART_BATCHING = "true"
ENABLE_PRE_SCREENING = "true"
USE_COMPRESSED_PROMPTS = "true"
ROLLOUT_PERCENTAGE = "100"

[[r2_buckets]]
binding = "R2_CACHE_BUCKET"
bucket_name = "oslira-preprocessor-cache"

[[env.staging.r2_buckets]]
binding = "R2_CACHE_BUCKET"
bucket_name = "oslira-preprocessor-cache"
